select c.IDCLIENTE,c.NOMBRE, R.COMPRA as COMPRA from customer as c, 
(select IDCLIENTE ,sum(valor) as COMPRA from sale
where FECHAVENTA >="2022-01-01" and FECHAVENTA <="2022-01-31" 
group by IDCLIENTE
order by COMPRA DESC
limit 5) as R
where c.IDCLIENTE = R.IDCLIENTE
order by R.COMPRA DESC


select IDCLIENTE,sum(valor) as COMPRA from sale
where FECHAVENTA >="2022-01-01" and FECHAVENTA <="2022-01-31" 
group by IDCLIENTE
order by COMPRA DESC
limit 5;



select s.IDPRODUCTO,R.NOMBRE,SUM(s.CANTIDAD) AS CANTIDAD
from sale as s, (SELECT * FROM PRODUCT) AS R
where s.FECHAVENTA >="2022-01-01" and s.FECHAVENTA <="2022-01-31" 
and s.IDPRODUCTO = R.IDPRODUCTO
group by s.IDPRODUCTO
ORDER BY CANTIDAD DESC;




SELECT IDCLIENTE,IDPRODUCTO,SUM(VALOR) AS VALOR
FROM sale as s

GROUP BY IDCLIENTE,IDPRODUCTO
ORDER BY IDCLIENTE DESC



SELECT c.NOMBRE AS NOMBRE_CLIENTE,P.NOMBRE AS NOMBRE_PRODUCTO,SUM(s.VALOR) AS VALOR
FROM sale as s, (SELECT * FROM CUSTOMER) as C,(SELECT * FROM PRODUCT) as P
where s.IDCLIENTE = C.IDCLIENTE AND
S.IDPRODUCTO = P.IDPRODUCTO
GROUP BY s.IDCLIENTE,s.IDPRODUCTO
ORDER BY s.IDCLIENTE DESC



